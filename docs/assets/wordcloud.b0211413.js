import{h as z,b as xt}from"./index.a8cad37f.js";function ct(t){return typeof t=="function"}function it(){}var X=function(t){this.previousValue=t,this.interrupted=!1,this.interruptHandlers=new Set};X.prototype.throwIfInterrupted=function(){if(this.interrupted)throw new Error},X.prototype.interrupt=function(){this.interrupted||(this.interrupted=!0,this.interruptHandlers.forEach(function(t){try{t()}catch{}}))},X.prototype.onInterrupt=function(t){if(this.interrupted&&!this.interruptHandlers.has(t))try{t()}catch{}this.interruptHandlers.add(t)};function Y(t){return function(){return t}}function ht(){return[]}var Et={animationDuration:{type:Number,default:1e3},animationEasing:{type:String,default:"ease"},animationOverlap:{type:Number,default:1},color:{type:[String,Function],default:"Black"},createCanvas:{type:Function,default:function(){return document.createElement("canvas")}},createWorker:{type:Function,default:function(t){return new Worker(URL.createObjectURL(new Blob([t])))}},enterAnimation:{type:[Object,String],default:Y({opacity:0})},fontFamily:{type:[String,Function],default:"serif"},fontSizeRatio:{type:Number,default:0},fontStyle:{type:[String,Function],default:"normal"},fontVariant:{type:[String,Function],default:"normal"},fontWeight:{type:[String,Function],default:"normal"},leaveAnimation:{type:[Object,String],default:Y({opacity:0})},loadFont:{type:Function,default:function(t,e,i,r){return document.fonts.load([e,i,"1px",t].join(" "),r)}},rotation:{type:[Number,Function],default:0},rotationUnit:{type:[String,Function],default:"turn"},spacing:{type:Number,default:0},text:{type:[String,Function],default:""},weight:{type:[Number,Function],default:1},words:{type:Array,default:ht}},Ft=Y(null);function nt(t){if(t){var e=typeof t;return e==="object"||e==="function"}return!1}function et(t){return typeof t=="string"}var St={animationOptions:function(){var t,e,i,r=this.animationDuration,o=this.enterAnimation,a=this.leaveAnimation;if(nt(o)&&nt(a)){var n=(t=Object.assign({},o,a),e=Ft,i={},Object.entries(t).forEach(function(f){var m=f[0],E=f[1];i[m]=e(E,m,t)}),i),l=function(f){Object.assign(f.style,o)},g=function(f,m){setTimeout(function(){Object.assign(f.style,n),setTimeout(m,r)},1)};return{props:{css:!1},on:{beforeAppear:l,appear:g,beforeEnter:l,enter:g,leave:function(f,m){Object.assign(f.style,a),setTimeout(m,r)}}}}return et(o)&&et(a)?{props:{duration:r,appear:!0,appearActiveClass:o,enterActiveClass:o,leaveActiveClass:a}}:{}},normalizedAnimationOverlap:function(){var t=this.animationOverlap;return(t=Math.abs(t))<1&&(t=1/t),t},separateAnimationDelay:function(){var t=this.cloudWords;return t.length>1?(this.animationDuration-this.separateAnimationDuration)/(t.length-1):0},separateAnimationDuration:function(){var t=this.cloudWords;if(t.length>0){var e=this.animationDuration,i=this.normalizedAnimationOverlap;return e/Math.min(i,t.length)}return 0}},At=Array.isArray;function D(t){return ct(t)?t:Y(t)}var lt=2*Math.PI,It=lt/360;function _(t){return t===void 0}function U(t,e){return t.postMessage(e),function(i){return new Promise(function(r,o){var a,n=function(g){var f=g.data;a(),r(f)},l=function(g){var f=g.error;a(),o(f)};a=function(){i.removeEventListener("message",n),i.removeEventListener("error",l)},i.addEventListener("message",n),i.addEventListener("error",l)})}(t)}function ot(t,e,i){return Math.ceil(t*Math.abs(Math.sin(i))+e*Math.abs(Math.cos(i)))}function at(t,e,i){return Math.ceil(t*Math.abs(Math.cos(i))+e*Math.abs(Math.sin(i)))}function tt(t,e,i,r,o){return[t,e,i,r+"px",o].join(" ")}function ut(t,e){return Math.ceil(t/e)*e}function st(t,e,i){var r=i().getContext("2d");return r.font=e,r.measureText(t).width}var dt=function(t,e,i,r,o,a,n){this.t=t,this.i=e,this.o=i,this.u=r,this.s=o,this.h=a,this.l=n,this.v=1,this.m=0,this.p=0,this.g=0},h={M:{configurable:!0},S:{configurable:!0},F:{configurable:!0},j:{configurable:!0},O:{configurable:!0},W:{configurable:!0},A:{configurable:!0},B:{configurable:!0},C:{configurable:!0},L:{configurable:!0},_:{configurable:!0},P:{configurable:!0},T:{configurable:!0},N:{configurable:!0},k:{configurable:!0},D:{configurable:!0},H:{configurable:!0},R:{configurable:!0},U:{configurable:!0}};h.M.get=function(){return this.v},h.M.set=function(t){this.v!==t&&(this.v=t,this.V=void 0)},h.S.get=function(){return tt(this.h,this.s,this.u,this.M,this.o)},h.F.get=function(){return this.q===void 0&&(this.q=st(this.t,tt(this.h,this.s,this.u,1,this.o),this.l)),this.q},h.j.get=function(){return this.F*this.M},h.O.get=function(){return this.p*this.M},h.O.set=function(t){this.p=t/this.M},h.W.get=function(){return this.g*this.M},h.W.set=function(t){this.g=t/this.M},h.A.get=function(){return at(this.j,this.M,this.i)},h.B.get=function(){return ot(this.j,this.M,this.i)},h.C.get=function(){return this.O-this.A/2},h.L.get=function(){return this.W-this.B/2},h._.get=function(){return this.m},h._.set=function(t){this.m!==t&&(this.m=t,this.V=void 0)},h.P.get=function(){return this.V===void 0&&(this.V=function(t,e,i,r,o,a,n,l,g){var f=tt(e,i,r,o*=4,a),m=n*o*2,E=m+st(t,f,g),F=m+o,W=g(),M=W.getContext("2d"),P=ut(at(E,F,l),4),C=ut(ot(E,F,l),4);W.width=P,W.height=C,M.translate(P/2,C/2),M.rotate(l),M.font=f,M.textAlign="center",M.textBaseline="middle",M.fillText(t,0,0),m>0&&(M.miterLimit=1,M.lineWidth=m,M.strokeText(t,0,0));for(var k=M.getImageData(0,0,P,C).data,V=[],R=1/0,N=0,T=1/0,B=0,K=P/4,q=C/4,L=0;L<K;++L)for(var H=0;H<q;++H)t:for(var G=0;G<4;++G)for(var $=0;$<4;++$)if(k[4*(P*(4*H+$)+(4*L+G))+3]){V.push([L,H]),R=Math.min(L,R),N=Math.max(L+1,N),T=Math.min(H,T),B=Math.max(H+1,B);break t}return V.length>0?[V.map(function(J){var Z=J[0],s=J[1];return[Z-R,s-T]}),N-R,B-T,Math.ceil(K/2)-R,Math.ceil(q/2)-T]:[V,0,0,0,0]}(this.t,this.h,this.s,this.u,this.M,this.o,this._,this.i,this.l)),this.V},h.T.get=function(){return this.P[0]},h.N.get=function(){return this.P[1]},h.k.get=function(){return this.P[2]},h.D.get=function(){return this.P[3]},h.H.get=function(){return this.P[4]},h.R.get=function(){return Math.ceil(this.O)-this.D},h.R.set=function(t){this.O=t+this.D},h.U.get=function(){return Math.ceil(this.W)-this.H},h.U.set=function(t){this.W=t+this.H},Object.defineProperties(dt.prototype,h);var Pt={cloudWords:function(t){this.$emit("update:cloudWords",t)},progress:{handler:function(t){this.$emit("update:progress",t)},deep:!0,immediate:!0}},Dt={updateElementSize:function(){var t=this.$el;t&&(this.elementWidth=t.offsetWidth,this.elementHeight=t.offsetHeight)}},ft={name:"VueWordCloud",mixins:[function(t){return{data:function(){var e={};return Object.keys(t).forEach(function(i){e["asyncComputed_trigger_"+i]={}}),e},computed:{},beforeCreate:function(){var e=this,i=new Set;Object.entries(t).forEach(function(r){var o=r[0],a=r[1],n=a.get,l=a.default,g=a.errorHandler;g===void 0&&(g=it);var f,m=!0;e.$options.computed[o]=function(){return this["asyncComputed_trigger_"+o],this["asyncComputed_promise_"+o],l},e.$options.computed["asyncComputed_promise_"+o]=function(){var E=this;f&&(f.interrupt(),i.delete(f)),m&&(m=!1,ct(l)&&(l=l.call(this)));var F=new X(l);f=F,i.add(f),new Promise(function(W){W(n.call(E,F))}).then(function(W){F.throwIfInterrupted(),l=W,E["asyncComputed_trigger_"+o]={}}).catch(g)}})}}}({cloudWords:{get:function(t){var e,i=this,r=this,o=r.elementWidth,a=r.elementHeight,n=r.words,l=r.text,g=r.weight,f=r.rotation,m=r.rotationUnit,E=r.fontFamily,F=r.fontWeight,W=r.fontVariant,M=r.fontStyle,P=r.color,C=r.spacing,k=r.fontSizeRatio,V=r.createCanvas,R=r.loadFont,N=r.createWorker;e=k,k=(e=Math.abs(e))>1?1/e:e;var T=function(s){var d=s[0],b=s[1];return d>b?[1,b/d]:b>d?[d/b,1]:[1,1]}([o,a]);if(o>0&&a>0){var B=D(l),K=D(g),q=D(f),L=D(m),H=D(E),G=D(F),$=D(W),J=D(M),Z=D(P);return n=n.map(function(s,d){var b,v,S,w,A,u,c,p,O,j,I;s&&(et(s)?S=s:At(s)?(S=(b=s)[0],w=b[1]):nt(s)&&(S=(v=s).text,w=v.weight,A=v.rotation,u=v.rotationUnit,c=v.fontFamily,p=v.fontWeight,O=v.fontVariant,j=v.fontStyle,I=v.color)),_(S)&&(S=B(s,d,n)),_(w)&&(w=K(s,d,n)),_(A)&&(A=q(s,d,n)),_(u)&&(u=L(s,d,n)),_(c)&&(c=H(s,d,n)),_(p)&&(p=G(s,d,n)),_(O)&&(O=$(s,d,n)),_(j)&&(j=J(s,d,n)),_(I)&&(I=Z(s,d,n));var x=new dt(S,function(){switch(u){case"turn":return A*lt;case"deg":return function(y){return y*It}(A)}return A}(),c,p,O,j,V);return Object.assign(x,{J:s,G:w,I}),x}),Promise.resolve().then(function(){return Promise.all(n.map(function(s){var d=s.o,b=s.h,v=s.u,S=s.t;return R(d,b,v,S)}))}).catch(it).then(function(){if((n=n.filter(function(u){return u.j>0}).sort(function(u,c){return c.G-u.G})).length>0){var s=n[0],d=function(u){return u[c=u,c.length-1];var c}(n),b=s.G,v=d.G;if(v<b){var S=k>0?1/k:v>0?b/v:b<0?v/b:1+b-v;n.forEach(function(u){var c,p,O;u.M=(c=u.G,(O=1)+(c-(p=v))*(S-O)/(b-p))})}n.reduceRight(function(u,c){return c.M<2*u?c.M/=u:(u=c.M,c.M=1),c.K=u},1),n.forEach(function(u){u.M*=4});var w=N(`!function(){"use strict";var r=function(t){self.removeEventListener("message",r);var n,e,a,f,i,u=t.data,o=function(){n={},e=0,a=0,f=0,i=0};o();var s=function(){return Math.ceil((e+a)/2)},v=function(){return Math.ceil((f+i)/2)},c=function(){return{left:s(),top:v(),width:a-e,height:i-f}},l=function(r,t,u){r.forEach((function(r){var o=r[0],s=r[1],v=t+o,c=u+s;n[v+"|"+c]=!0,e=Math.min(v,e),a=Math.max(v+1,a),f=Math.min(c,f),i=Math.max(c+1,i)}))},h=function(r,t,e){return function(r,t,n){var e,a,f=r[0],i=r[1],u=t[0],o=t[1];f>i?(e=1,a=i/f):i>f?(a=1,e=f/i):e=a=1;var s=[u,o];if(n(s))return s;for(var v=u,c=o,l=u,h=o,M=v,d=c;;){u-=e,o-=a,v+=e,c+=a;var m=Math.floor(u),g=Math.floor(o),p=Math.ceil(v),E=Math.ceil(c);if(p>M)for(var L=g;L<E;++L){var x=[p,L];if(n(x))return x}if(E>d)for(var y=p;y>m;--y){var w=[y,E];if(n(w))return w}if(m<l)for(var B=E;B>g;--B){var F=[m,B];if(n(F))return F}if(g<h)for(var b=m;b<p;++b){var j=[b,g];if(n(j))return j}l=m,h=g,M=p,d=E}}(u,[t+s(),e+v()],(function(t){var e=t[0],a=t[1];return function(r,t,e){return r.every((function(r){var a=r[0],f=r[1];return!n[t+a+"|"+(e+f)]}))}(r,e,a)}))};self.postMessage({}),self.addEventListener("message",(function(r){self.postMessage({getBounds:c,put:l,findFit:h,clear:o}[r.data.name].apply(null,r.data.args))}))};self.addEventListener("message",r)}();
`),A={completedWords:0,totalWords:n.length};return Promise.resolve().then(function(){return t.throwIfInterrupted(),i.progress=A,U(w,T)}).then(function(){t.throwIfInterrupted(),A.completedWords++;var u=Promise.resolve();return n.reduce(function(c,p,O){return u=u.then(function(){return p.K<c.K?Promise.resolve().then(function(){return U(w,{name:"clear"})}).then(function(){var j=Promise.resolve(),I=c.K/p.K;return n.slice(0,O).forEach(function(x){j=j.then(function(){return x.M*=I,U(w,{name:"put",args:[x.T,x.R,x.U]})})}),j}):U(w,{name:"put",args:[c.T,c.R,c.U]})}).then(function(){return p._=C,U(w,{name:"findFit",args:[p.T,p.R,p.U]})}).then(function(j){var I=j[0],x=j[1];t.throwIfInterrupted(),A.completedWords++,p.R=I,p.U=x,p._=0}),p}),u}).then(function(){return U(w,{name:"put",args:[d.T,d.R,d.U]})}).then(function(){return U(w,{name:"getBounds"})}).then(function(u){var c=u.left,p=u.top,O=u.width,j=u.height;if(O>0&&j>0){var I=Math.min(o/O,a/j);n.forEach(function(y){y.O-=c,y.W-=p,y.M*=I})}var x=new Set;return n.map(function(y){for(var pt=y.J,rt=y.t,mt=y.G,gt=y.i,vt=y.o,yt=y.u,bt=y.s,Mt=y.h,wt=y.S,jt=y.O,Wt=y.W,Ot=y.I,Q=JSON.stringify([rt,vt,yt,bt,Mt]);x.has(Q);)Q+="!";return x.add(Q),{key:Q,word:pt,text:rt,weight:mt,rotation:gt,font:wt,color:Ot,left:jt,top:Wt}})}).finally(function(){w.terminate()}).finally(function(){t.throwIfInterrupted(),i.progress=null})}return[]})}return[]},default:ht}})],props:Et,data:function(){return{elementWidth:0,elementHeight:0,progress:null}},computed:St,watch:Pt,mounted:function(){var t,e,i=this;t=function(){if(i._isDestroyed)return!1;i.updateElementSize()},e=1e3,function(r){var o=function(){for(var a=[],n=arguments.length;n--;)a[n]=arguments[n];return r.call.apply(r,[this,o].concat(a))};return o}(function(r){requestAnimationFrame(function(){t()!==!1&&setTimeout(r,e)})})()},methods:Dt,render:function(){var t=this.$slots,e=this.animationEasing,i=this.animationOptions,r=this.cloudWords,o=this.separateAnimationDelay,a=this.separateAnimationDuration;return t=Object.assign({},{default:function(n){return n.text}},t),z("div",{style:{height:"100%",position:"relative",width:"100%"}},[z("div",{style:{bottom:"50%",position:"absolute",right:"50%",transform:"translate(50%,50%)"}},r.map(function(n,l){var g=n.color,f=n.font,m=n.left,E=n.rotation,F=n.text,W=n.top,M=n.weight,P=n.word;return z("transition",Object.assign({},i),[z("div",{key:l,style:Object.assign({},{left:m+"px",position:"absolute",top:W+"px"},a>0?{animation:[a+"ms",e,o*l+"ms"].join(" "),transition:["all",a+"ms",e,o*l+"ms"].join(" ")}:{})},[z("div",{style:Object.assign({},{bottom:"50%",color:g,font:f,position:"absolute",right:"50%",transform:["translate(50%,50%)","rotate("+E+"rad)"].join(" "),whiteSpace:"nowrap"},a>0?{transition:["all",a+"ms",e,o*l+"ms"].join(" ")}:{})},[t.default({color:g,font:f,left:m,text:F,top:W,weight:M,word:P})])])])}))])}},Lt=xt(async({app:t})=>{t.component(ft.name,ft)});export{Lt as default};
